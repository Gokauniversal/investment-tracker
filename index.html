<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–∫–µ—Ä –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/prop-types@15.8.1/prop-types.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/recharts/2.0.9/recharts.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, sans-serif; }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;
        
        const Recharts = window.Recharts; // –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–ª—É—á–∏—Ç—å Recharts –∏–∑ window

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∑–∞–≥—Ä—É–∂–µ–Ω –ª–∏ Recharts, –∏–Ω–∞—á–µ –≤—ã–≤–æ–¥–∏–º –æ—à–∏–±–∫—É –≤ –∫–æ–Ω—Å–æ–ª—å
        if (typeof Recharts === 'undefined' || !Recharts.LineChart) {
            console.error("Recharts is not properly loaded or accessible. Please check the CDN link and Recharts documentation for direct browser usage.");
        }

        // –î–µ—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã Recharts. –î–æ–±–∞–≤–∏–ª || {} –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
        const { LineChart, Line, XAxis, YAxis, CartesianGrid, Tooltip, Legend, ResponsiveContainer, PieChart, Pie, Cell } = Recharts || {};
        
        // –ò–∫–æ–Ω–∫–∏ (—É–ø—Ä–æ—â–µ–Ω–Ω—ã–µ)
        const PlusIcon = () => <span style={{fontSize: '16px'}}>‚ûï</span>;
        const TrashIcon = () => <span style={{fontSize: '16px'}}>üóëÔ∏è</span>;
        const TrendingUpIcon = () => <span style={{fontSize: '16px'}}>üìà</span>;
        const DollarIcon = () => <span style={{fontSize: '16px'}}>üí∞</span>;
        const CalculatorIcon = () => <span style={{fontSize: '16px'}}>üßÆ</span>;

        const InvestmentTracker = () => {
            const [savingsAccount, setSavingsAccount] = useState({
                balance: 100000,
                rate: 5.5,
                entries: [
                    { date: '2024-01-01', amount: 100000, type: 'deposit', description: '–ù–∞—á–∞–ª—å–Ω—ã–π –¥–µ–ø–æ–∑–∏—Ç' }
                ]
            });

            const [stocks, setStocks] = useState([
                { id: 1, name: '–°–±–µ—Ä–±–∞–Ω–∫', ticker: 'SBER', shares: 100, buyPrice: 250, currentPrice: 280, date: '2024-01-15' },
                { id: 2, name: '–ì–∞–∑–ø—Ä–æ–º', ticker: 'GAZP', shares: 50, buyPrice: 180, currentPrice: 165, date: '2024-02-01' }
            ]);

            const [newStock, setNewStock] = useState({
                name: '', ticker: '', shares: '', buyPrice: '', currentPrice: '', date: ''
            });

            const [newSavingsEntry, setNewSavingsEntry] = useState({
                date: '', amount: '', type: 'deposit', description: ''
            });

            const [activeTab, setActiveTab] = useState('overview');

            useEffect(() => {
                const calculatedBalance = savingsAccount.entries.reduce((acc, entry) => {
                    return entry.type === 'deposit' ? acc + entry.amount : acc - entry.amount;
                }, 0);
                setSavingsAccount(prev => ({ ...prev, balance: calculatedBalance }));
            }, [savingsAccount.entries]);

            const savingsData = useMemo(() => {
                let balance = 0;
                const sortedEntries = [...savingsAccount.entries].sort((a, b) => new Date(a.date) - new Date(b.date));

                return sortedEntries.map(entry => {
                    balance += entry.type === 'deposit' ? entry.amount : -entry.amount;
                    return {
                        date: entry.date,
                        balance: balance,
                    };
                });
            }, [savingsAccount.entries]);

            const stocksData = useMemo(() => {
                return stocks.map(stock => {
                    const totalCost = stock.shares * stock.buyPrice;
                    const currentValue = stock.shares * stock.currentPrice;
                    const profit = currentValue - totalCost;
                    const profitPercent = (profit / totalCost) * 100;
                    
                    return {
                        ...stock,
                        totalCost,
                        currentValue,
                        profit,
                        profitPercent
                    };
                });
            }, [stocks]);

            const totalStockValue = stocksData.reduce((sum, stock) => sum + stock.currentValue, 0);
            const totalStockCost = stocksData.reduce((sum, stock) => sum + stock.totalCost, 0);
            const totalStockProfit = totalStockValue - totalStockCost;
            const currentSavingsBalance = savingsAccount.balance;

            const portfolioData = [
                { name: '–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π —Å—á—ë—Ç', value: currentSavingsBalance, color: '#8884d8' },
                { name: '–ê–∫—Ü–∏–∏', value: totalStockValue, color: '#82ca9d' }
            ];

            const addStock = () => {
                if (newStock.name && newStock.ticker && newStock.shares && newStock.buyPrice && newStock.currentPrice && newStock.date) {
                    setStocks([...stocks, {
                        ...newStock,
                        id: Date.now(),
                        shares: parseFloat(newStock.shares),
                        buyPrice: parseFloat(newStock.buyPrice),
                        currentPrice: parseFloat(newStock.currentPrice)
                    }]);
                    setNewStock({ name: '', ticker: '', shares: '', buyPrice: '', currentPrice: '', date: '' });
                } else {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è –¥–ª—è –∞–∫—Ü–∏–∏.');
                }
            };

            const removeStock = (id) => {
                setStocks(stocks.filter(stock => stock.id !== id));
            };

            const addSavingsEntry = () => {
                if (newSavingsEntry.date && newSavingsEntry.amount) {
                    const newEntries = [...savingsAccount.entries, {
                        ...newSavingsEntry,
                        amount: parseFloat(newSavingsEntry.amount)
                    }];
                    setSavingsAccount({
                        ...savingsAccount,
                        entries: newEntries
                    });
                    setNewSavingsEntry({ date: '', amount: '', type: 'deposit', description: '' });
                } else {
                    alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –¥–∞—Ç—É –∏ —Å—É–º–º—É –¥–ª—è –æ–ø–µ—Ä–∞—Ü–∏–∏.');
                }
            };

            const formatCurrency = (amount) => {
                return new Intl.NumberFormat('ru-RU', {
                    style: 'currency',
                    currency: 'RUB',
                    minimumFractionDigits: 0
                }).format(amount);
            };

            return (
                <div className="max-w-7xl mx-auto p-6 bg-gray-50 min-h-screen">
                    <div className="bg-white rounded-lg shadow-lg p-6 mb-6">
                        <h1 className="text-3xl font-bold text-gray-800 mb-2 flex items-center gap-2">
                            <TrendingUpIcon />
                            –¢—Ä–µ–∫–µ—Ä –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –∏–Ω–≤–µ—Å—Ç–∏—Ü–∏–π
                        </h1>
                        <p className="text-gray-600">–£—á—ë—Ç –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å—á—ë—Ç–∞ –∏ –∞–∫—Ü–∏–π</p>
                    </div>

                    {/* –ù–∞–≤–∏–≥–∞—Ü–∏—è */}
                    <div className="bg-white rounded-lg shadow mb-6">
                        <div className="flex border-b">
                            {[
                                { id: 'overview', name: '–û–±–∑–æ—Ä', icon: CalculatorIcon },
                                { id: 'savings', name: '–ù–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π —Å—á—ë—Ç', icon: DollarIcon },
                                { id: 'stocks', name: '–ê–∫—Ü–∏–∏', icon: TrendingUpIcon }
                            ].map(tab => (
                                <button
                                    key={tab.id}
                                    onClick={() => setActiveTab(tab.id)}
                                    className={`flex items-center gap-2 px-6 py-4 font-medium ${
                                        activeTab === tab.id
                                            ? 'text-blue-600 border-b-2 border-blue-600 bg-blue-50'
                                            : 'text-gray-600 hover:text-blue-600'
                                    }`}
                                >
                                    <tab.icon />
                                    {tab.name}
                                </button>
                            ))}
                        </div>
                    </div>

                    {activeTab === 'overview' && (
                        <div className="space-y-6">
                            {/* –°–≤–æ–¥–∫–∞ */}
                            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div className="bg-white p-6 rounded-lg shadow">
                                    <h3 className="text-lg font-semibold text-gray-700 mb-2">–û–±—â–∞—è —Å—Ç–æ–∏–º–æ—Å—Ç—å –ø–æ—Ä—Ç—Ñ–µ–ª—è</h3>
                                    <p className="text-3xl font-bold text-blue-600">
                                        {formatCurrency(currentSavingsBalance + totalStockValue)}
                                    </p>
                                </div>
                                <div className="bg-white p-6 rounded-lg shadow">
                                    <h3 className="text-lg font-semibold text-gray-700 mb-2">–ü—Ä–∏–±—ã–ª—å –ø–æ –∞–∫—Ü–∏—è–º</h3>
                                    <p className={`text-3xl font-bold ${totalStockProfit >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                        {formatCurrency(totalStockProfit)}
                                    </p>
                                    <p className={`text-sm ${totalStockProfit >= 0 ? 'text-green-600' : 'text-red-600'}`}>
                                        {totalStockCost > 0 ? ((totalStockProfit / totalStockCost) * 100).toFixed(2) : 0}%
                                    </p>
                                </div>
                                <div className="bg-white p-6 rounded-lg shadow">
                                    <h3 className="text-lg font-semibold text-gray-700 mb-2">–°—Ç–∞–≤–∫–∞ –ø–æ –¥–µ–ø–æ–∑–∏—Ç—É</h3>
                                    <p className="text-3xl font-bold text-green-600">{savingsAccount.rate}%</p>
                                </div>
                            </div>

                            {/* –î–∏–∞–≥—Ä–∞–º–º–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è */}
                            <div className="bg-white p-6 rounded-lg shadow">
                                <h3 className="text-xl font-semibold mb-4">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ—Ä—Ç—Ñ–µ–ª—è</h3>
                                <div style={{height: '320px'}}>
                                    {Recharts && PieChart && Pie && Cell && Tooltip && Legend ? (
                                        <ResponsiveContainer width="100%" height="100%">
                                            <PieChart>
                                                <Pie
                                                    data={portfolioData}
                                                    cx="50%"
                                                    cy="50%"
                                                    labelLine={false}
                                                    label={({name, percent}) => `${name}: ${(percent * 100).toFixed(0)}%`}
                                                    outerRadius={80}
                                                    fill="#8884d8"
                                                    dataKey="value"
                                                >
                                                    {portfolioData.map((entry, index) => (
                                                        <Cell key={`cell-${index}`} fill={entry.color} />
                                                    ))}
                                                </Pie>
                                                <Tooltip 
                                                    formatter={(value) => formatCurrency(value)}
                                                />
                                                <Legend />
                                            </PieChart>
                                        </ResponsiveContainer>
                                    ) : (
                                        <div className="text-red-500">–ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ—Ä—Ç—Ñ–µ–ª—è –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω –∏–∑-–∑–∞ –ø—Ä–æ–±–ª–µ–º —Å –∑–∞–≥—Ä—É–∑–∫–æ–π Recharts.</div>
                                    )}
                                </div>
                            </div>
                        </div>
                    )}

                    {activeTab === 'savings' && (
                        <div className="space-y-6">
                            {/* –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å—á—ë—Ç–∞ */}
                            <div className="bg-white p-6 rounded-lg shadow">
                                <h3 className="text-xl font-semibold mb-4">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Å—á—ë—Ç–∞</h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">–¢–µ–∫—É—â–∏–π –±–∞–ª–∞–Ω—Å</label>
                                        <input
                                            type="text"
                                            value={formatCurrency(savingsAccount.balance)}
                                            readOnly
                                            className="w-full p-2 border border-gray-300 rounded-md bg-gray-100"
                                        />
                                    </div>
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-1">–ü—Ä–æ—Ü–µ–Ω—Ç–Ω–∞—è —Å—Ç–∞–≤–∫–∞ (%)</label>
                                        <input
                                            type="number"
                                            step="0.1"
                                            value={savingsAccount.rate}
                                            onChange={(e) => setSavingsAccount({...savingsAccount, rate: parseFloat(e.target.value) || 0})}
                                            className="w-full p-2 border border-gray-300 rounded-md"
                                        />
                                    </div>
                                </div>
                            </div>

                            {/* –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ */}
                            <div className="bg-white p-6 rounded-lg shadow">
                                <h3 className="text-xl font-semibold mb-4">–î–æ–±–∞–≤–∏—Ç—å –æ–ø–µ—Ä–∞—Ü–∏—é</h3>
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap